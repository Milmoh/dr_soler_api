2025-12-17 10:38:39,036 - INFO - 
======================================================================
2025-12-17 10:38:39,037 - INFO - APPOINTMENT SCHEDULING SYSTEM
2025-12-17 10:38:39,037 - INFO - ======================================================================
2025-12-17 10:38:39,038 - INFO - String:     Dr. Soler 12:00 TEMPORAL COELHO, ARTUR
2025-12-17 10:38:39,038 - INFO - ======================================================================

2025-12-17 10:38:39,038 - INFO - Launching RDP session to salus.q-soft.net:8399...
2025-12-17 10:38:39,044 - INFO - Waiting for images/pantalla_inicial.png to appear (confidence=0.7)...
2025-12-17 10:38:57,003 - INFO - Image found at Box(left=np.int64(614), top=np.int64(296), width=682, height=466)
2025-12-17 10:38:57,003 - INFO - Clicking on image at (955.0, 529.0)...
2025-12-17 10:38:58,120 - INFO - Typing credentials...
2025-12-17 10:38:58,539 - INFO - Login submitted.
2025-12-17 10:39:03,539 - INFO - 
Scheduling appointment...
2025-12-17 10:39:03,540 - INFO - 
Setting appointment date to: 24/12/2025
2025-12-17 10:39:03,540 - INFO - 
=== Changing appointment date ===
2025-12-17 10:39:03,541 - INFO - Looking for 'Calendario' label...
2025-12-17 10:39:03,541 - INFO - Waiting for images/calendario.png to appear (confidence=0.95)...
2025-12-17 10:39:07,394 - INFO - Image found at Box(left=np.int64(27), top=np.int64(351), width=141, height=38)
2025-12-17 10:39:07,394 - INFO - 'Calendario' label found at (97.5, 370.0)
2025-12-17 10:39:07,395 - INFO - Clicking on 'Calendario' label...
2025-12-17 10:39:07,797 - INFO - Pressing Tab 2 times to reach date field...
2025-12-17 10:39:08,504 - INFO - Clearing existing date...
2025-12-17 10:39:10,987 - INFO - Typing new date: 24/12/2025
2025-12-17 10:39:12,408 - INFO - Pressing Enter to confirm...
2025-12-17 10:39:13,010 - INFO - Date changed successfully to: 24/12/2025
2025-12-17 10:39:14,012 - INFO - 
======================================================================
2025-12-17 10:39:14,013 - INFO - SISTEMA AUTOMÁTICO DE AGENDAMIENTO DE CITAS
2025-12-17 10:39:14,014 - INFO - ======================================================================
2025-12-17 10:39:14,014 - INFO - Input: Dr. Soler 12:00 TEMPORAL COELHO, ARTUR

2025-12-17 10:39:14,015 - INFO - Parseado exitoso:
2025-12-17 10:39:14,015 - INFO -  - Doctor: Dr. Soler
2025-12-17 10:39:14,015 - INFO -  - Hora: 12:00
2025-12-17 10:39:14,016 - INFO -  - Paciente: TEMPORAL COELHO, ARTUR

2025-12-17 10:39:14,017 - INFO -  - Nombre del paciente: TEMPORAL COELHO, ARTUR

2025-12-17 10:39:14,017 - INFO -  - Tipo de consulta: C - Consulta Nuevo Paciente

2025-12-17 10:39:14,017 - INFO - 
=== Scheduling appointment with images/doctors/dr_soler.png at 12:00 ===
2025-12-17 10:39:14,018 - INFO - Searching for doctor column: images/doctors/dr_soler.png...
2025-12-17 10:39:14,018 - INFO - Waiting for images/doctors/dr_soler.png to appear (confidence=0.95)...
2025-12-17 10:39:14,258 - INFO - Image found at Box(left=np.int64(373), top=np.int64(378), width=84, height=26)
2025-12-17 10:39:14,258 - INFO - Doctor column found at X=415.0
2025-12-17 10:39:14,259 - INFO - Searching for time row: 12:00...
2025-12-17 10:39:14,259 - INFO - Time image path: images/times/time_12_00.png
2025-12-17 10:39:14,383 - INFO - Time row found at Y=943.5
2025-12-17 10:39:14,384 - INFO - Double-clicking at intersection: (415.0, 943.5)
2025-12-17 10:39:14,496 - INFO - Appointment slot clicked successfully!
2025-12-17 10:39:14,997 - INFO - Typing patient name: TEMPORAL COELHO, ARTUR
2025-12-17 10:39:16,991 - INFO - Looking for 'añadir_paciente' button...
2025-12-17 10:39:16,992 - INFO - Waiting for images/anyadir_paciente.png to appear (confidence=0.9) (grayscale)...
2025-12-17 10:39:18,379 - INFO - Image found at Box(left=np.int64(851), top=np.int64(579), width=14, height=22)
2025-12-17 10:39:18,380 - INFO - Clicking on image at (858.0, 590.0)...
2025-12-17 10:39:19,483 - INFO - 
Selecting consultation type: C - Consulta Nuevo Paciente
2025-12-17 10:39:19,483 - INFO - Looking for 'lupa' button...
2025-12-17 10:39:19,484 - INFO - Waiting for images/lupa.png to appear (confidence=0.7)...
2025-12-17 10:39:19,715 - INFO - Image found at Box(left=np.int64(1443), top=np.int64(437), width=39, height=29)
2025-12-17 10:39:19,715 - INFO - Clicking on image at (1462.5, 451.5)...
2025-12-17 10:39:20,820 - INFO - Looking for consultation type: C - Consulta Nuevo Paciente
2025-12-17 10:39:20,820 - INFO - Waiting for images/tipos_consulta/c_consulta_nuevo_paciente.png to appear (confidence=0.7)...
2025-12-17 10:39:21,039 - INFO - Image found at Box(left=np.int64(656), top=np.int64(446), width=237, height=26)
2025-12-17 10:39:21,040 - INFO - Double-clicking on image at (774.5, 459.0)...
2025-12-17 10:39:21,652 - INFO - Consultation type 'C - Consulta Nuevo Paciente' selected successfully!
2025-12-17 10:39:21,653 - INFO - Waiting for images/guardar.png to appear (confidence=0.9)...
2025-12-17 10:39:23,907 - INFO - Image not found within timeout: images/guardar.png
2025-12-17 10:39:23,908 - INFO - Image images/guardar.png not found, exiting...
2025-12-17 10:39:23,910 - INFO - 'Guardar' button not visible, attempting to scroll using right bar...
2025-12-17 10:39:23,912 - INFO - Waiting for images/barra_lateral.png to appear (confidence=0.7)...
2025-12-17 10:39:24,112 - INFO - Image found at Box(left=np.int64(1889), top=np.int64(124), width=28, height=800)
2025-12-17 10:39:24,113 - INFO - Clicking and dragging right bar at (1903.0, 524.0)...
2025-12-17 10:39:24,822 - INFO - Dragging down...
2025-12-17 10:39:27,094 - INFO - Waiting for images/guardar.png to appear (confidence=0.8)...
2025-12-17 10:39:27,334 - INFO - Image found at Box(left=np.int64(1356), top=np.int64(905), width=129, height=60)
2025-12-17 10:39:27,335 - INFO - Clicking on image at (1420.5, 935.0)...
2025-12-17 10:39:28,438 - INFO - Appointment saved successfully after scrolling!
2025-12-17 10:39:28,439 - INFO - 
¡Cita agendada exitosamente!
2025-12-17 10:39:28,439 - INFO - ======================================================================
2025-12-17 10:39:31,441 - INFO - Waiting for images/logout.png to appear (confidence=0.8)...
2025-12-17 10:39:31,707 - INFO - Image found at Box(left=np.int64(13), top=np.int64(94), width=110, height=113)
2025-12-17 10:39:31,707 - INFO - Clicking on image at (68.0, 150.5)...
2025-12-17 10:39:32,813 - INFO - 
Closing RDP window...
2025-12-17 10:39:34,815 - INFO - Attempting to close RDP window with Alt+F4...
2025-12-17 10:39:35,920 - INFO -  RDP window closed with Alt+F4
2025-12-17 10:39:35,922 - INFO - Ensuring all RDP processes are terminated...
2025-12-17 10:39:36,135 - INFO -  RDP process terminated
2025-12-17 10:39:36,136 - INFO - 
======================================================================
2025-12-17 10:39:36,136 - INFO -  APPOINTMENT SCHEDULED SUCCESSFULLY
2025-12-17 10:39:36,136 - INFO - ======================================================================
