2025-12-18 16:29:52,378 - INFO - 
======================================================================
2025-12-18 16:29:52,378 - INFO - APPOINTMENT SCHEDULING SYSTEM
2025-12-18 16:29:52,378 - INFO - ======================================================================
2025-12-18 16:29:52,378 - INFO - String:     Dr. Soler 09:00 TEMPORAL COELHO, ARTUR
2025-12-18 16:29:52,378 - INFO - ======================================================================

2025-12-18 16:29:52,378 - INFO - Launching RDP session to salus.q-soft.net:8399...
2025-12-18 16:29:52,385 - INFO - Waiting for images/pantalla_inicial.png to appear (confidence=0.7)...
2025-12-18 16:30:10,511 - INFO - Image found at Box(left=np.int64(616), top=np.int64(295), width=682, height=466)
2025-12-18 16:30:10,512 - INFO - Clicking on image at (957.0, 528.0)...
2025-12-18 16:30:11,645 - INFO - Typing credentials...
2025-12-18 16:30:12,063 - INFO - Login submitted.
2025-12-18 16:30:17,064 - INFO - 
Scheduling appointment...
2025-12-18 16:30:17,064 - INFO - 
Setting appointment date to: 24/12/2025
2025-12-18 16:30:17,064 - INFO - 
=== Changing appointment date ===
2025-12-18 16:30:17,064 - INFO - Looking for 'Calendario' label...
2025-12-18 16:30:17,064 - INFO - Waiting for images/calendario.png to appear (confidence=0.95)...
2025-12-18 16:30:21,787 - INFO - Image found at Box(left=np.int64(27), top=np.int64(351), width=141, height=38)
2025-12-18 16:30:21,788 - INFO - 'Calendario' label found at (97.5, 370.0)
2025-12-18 16:30:21,788 - INFO - Clicking on 'Calendario' label...
2025-12-18 16:30:22,190 - INFO - Pressing Tab 2 times to reach date field...
2025-12-18 16:30:22,895 - INFO - Clearing existing date...
2025-12-18 16:30:25,394 - INFO - Typing new date: 24/12/2025
2025-12-18 16:30:26,834 - INFO - Pressing Enter to confirm...
2025-12-18 16:30:27,438 - INFO - Date changed successfully to: 24/12/2025
2025-12-18 16:30:28,440 - INFO - 
======================================================================
2025-12-18 16:30:28,440 - INFO - SISTEMA AUTOMÁTICO DE AGENDAMIENTO DE CITAS
2025-12-18 16:30:28,441 - INFO - ======================================================================
2025-12-18 16:30:28,441 - INFO - Input: Dr. Soler 09:00 TEMPORAL COELHO, ARTUR

2025-12-18 16:30:28,441 - INFO - Parseado exitoso:
2025-12-18 16:30:28,441 - INFO -  - Doctor: Dr. Soler
2025-12-18 16:30:28,441 - INFO -  - Hora: 09:00
2025-12-18 16:30:28,441 - INFO -  - Paciente: TEMPORAL COELHO, ARTUR

2025-12-18 16:30:28,441 - INFO -  - Nombre del paciente: TEMPORAL COELHO, ARTUR

2025-12-18 16:30:28,441 - INFO -  - Tipo de consulta: C - Consulta Nuevo Paciente

2025-12-18 16:30:28,441 - INFO - 
=== Scheduling appointment with images/doctors/dr_soler.png at 09:00 ===
2025-12-18 16:30:28,441 - INFO - Searching for doctor column: images/doctors/dr_soler.png...
2025-12-18 16:30:28,441 - INFO - Waiting for images/doctors/dr_soler.png to appear (confidence=0.95)...
2025-12-18 16:30:28,662 - INFO - Image found at Box(left=np.int64(373), top=np.int64(378), width=84, height=26)
2025-12-18 16:30:28,663 - INFO - Doctor column found at X=415.0
2025-12-18 16:30:28,663 - INFO - Searching for time row: 09:00...
2025-12-18 16:30:28,663 - INFO - Time image path: images/times/time_9_00.png
2025-12-18 16:30:28,788 - INFO - Time row found at Y=584.0
2025-12-18 16:30:28,789 - INFO - Double-clicking at intersection: (415.0, 584.0)
2025-12-18 16:30:28,898 - INFO - Appointment slot clicked successfully!
2025-12-18 16:30:29,399 - INFO - Typing patient name: TEMPORAL COELHO, ARTUR
2025-12-18 16:30:31,430 - INFO - Looking for 'añadir_paciente' button...
2025-12-18 16:30:31,431 - INFO - Waiting for images/anyadir_paciente.png to appear (confidence=0.9) (grayscale)...
2025-12-18 16:30:32,888 - INFO - Image found at Box(left=np.int64(851), top=np.int64(579), width=14, height=22)
2025-12-18 16:30:32,888 - INFO - Clicking on image at (858.0, 590.0)...
2025-12-18 16:30:33,991 - INFO - 
Selecting consultation type: C - Consulta Nuevo Paciente
2025-12-18 16:30:33,991 - INFO - Looking for 'lupa' button...
2025-12-18 16:30:33,992 - INFO - Waiting for images/lupa.png to appear (confidence=0.7)...
2025-12-18 16:30:34,295 - INFO - Image found at Box(left=np.int64(1443), top=np.int64(437), width=39, height=29)
2025-12-18 16:30:34,295 - INFO - Clicking on image at (1462.5, 451.5)...
2025-12-18 16:30:35,400 - INFO - Looking for consultation type: C - Consulta Nuevo Paciente
2025-12-18 16:30:35,400 - INFO - Waiting for images/tipos_consulta/c_consulta_nuevo_paciente.png to appear (confidence=0.7)...
2025-12-18 16:30:35,671 - INFO - Image found at Box(left=np.int64(656), top=np.int64(446), width=237, height=26)
2025-12-18 16:30:35,671 - INFO - Double-clicking on image at (774.5, 459.0)...
2025-12-18 16:30:36,274 - INFO - Consultation type 'C - Consulta Nuevo Paciente' selected successfully!
2025-12-18 16:30:36,275 - INFO - Waiting for images/guardar.png to appear (confidence=0.9)...
2025-12-18 16:30:38,582 - INFO - Image not found within timeout: images/guardar.png
2025-12-18 16:30:38,583 - INFO - Image images/guardar.png not found, exiting...
2025-12-18 16:30:38,583 - INFO - 'Guardar' button not visible, attempting to scroll using right bar...
2025-12-18 16:30:38,588 - INFO - Waiting for images/barra_lateral.png to appear (confidence=0.7)...
2025-12-18 16:30:38,777 - INFO - Image found at Box(left=np.int64(1889), top=np.int64(125), width=28, height=800)
2025-12-18 16:30:38,777 - INFO - Clicking and dragging right bar at (1903.0, 525.0)...
2025-12-18 16:30:39,480 - INFO - Dragging down...
2025-12-18 16:30:41,754 - INFO - Waiting for images/guardar.png to appear (confidence=0.8)...
2025-12-18 16:30:41,991 - INFO - Image found at Box(left=np.int64(1356), top=np.int64(905), width=129, height=60)
2025-12-18 16:30:41,992 - INFO - Clicking on image at (1420.5, 935.0)...
2025-12-18 16:30:43,099 - INFO - Appointment saved successfully after scrolling!
2025-12-18 16:30:43,099 - INFO - 
¡Cita agendada exitosamente!
2025-12-18 16:30:43,100 - INFO - ======================================================================
2025-12-18 16:30:46,101 - INFO - Waiting for images/logout.png to appear (confidence=0.8)...
2025-12-18 16:30:46,374 - INFO - Image found at Box(left=np.int64(13), top=np.int64(94), width=110, height=113)
2025-12-18 16:30:46,374 - INFO - Clicking on image at (68.0, 150.5)...
2025-12-18 16:30:47,478 - INFO - 
Closing RDP window...
2025-12-18 16:30:49,478 - INFO - Attempting to close RDP window with Alt+F4...
2025-12-18 16:30:50,582 - INFO -  RDP window closed with Alt+F4
2025-12-18 16:30:50,582 - INFO - Ensuring all RDP processes are terminated...
2025-12-18 16:30:50,706 - INFO -  RDP process terminated
2025-12-18 16:30:50,707 - INFO - 
======================================================================
2025-12-18 16:30:50,707 - INFO -  APPOINTMENT SCHEDULED SUCCESSFULLY
2025-12-18 16:30:50,707 - INFO - ======================================================================
