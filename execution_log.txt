2025-12-17 13:54:35,465 - INFO - 
======================================================================
2025-12-17 13:54:35,466 - INFO - APPOINTMENT SCHEDULING SYSTEM
2025-12-17 13:54:35,466 - INFO - ======================================================================
2025-12-17 13:54:35,466 - INFO - String:     Dr. Soler 09:00 TEMPORAL COELHO, ARTUR
2025-12-17 13:54:35,466 - INFO - ======================================================================

2025-12-17 13:54:35,466 - INFO - Launching RDP session to salus.q-soft.net:8399...
2025-12-17 13:54:35,471 - INFO - Waiting for images/pantalla_inicial.png to appear (confidence=0.7)...
2025-12-17 13:54:52,444 - INFO - Image found at Box(left=np.int64(614), top=np.int64(296), width=682, height=466)
2025-12-17 13:54:52,444 - INFO - Clicking on image at (955.0, 529.0)...
2025-12-17 13:54:53,573 - INFO - Typing credentials...
2025-12-17 13:54:53,988 - INFO - Login submitted.
2025-12-17 13:54:58,989 - INFO - 
Scheduling appointment...
2025-12-17 13:54:58,990 - INFO - 
Setting appointment date to: 24/12/2025
2025-12-17 13:54:58,990 - INFO - 
=== Changing appointment date ===
2025-12-17 13:54:58,990 - INFO - Looking for 'Calendario' label...
2025-12-17 13:54:58,990 - INFO - Waiting for images/calendario.png to appear (confidence=0.95)...
2025-12-17 13:55:03,546 - INFO - Image found at Box(left=np.int64(27), top=np.int64(351), width=141, height=38)
2025-12-17 13:55:03,546 - INFO - 'Calendario' label found at (97.5, 370.0)
2025-12-17 13:55:03,547 - INFO - Clicking on 'Calendario' label...
2025-12-17 13:55:03,950 - INFO - Pressing Tab 2 times to reach date field...
2025-12-17 13:55:04,655 - INFO - Clearing existing date...
2025-12-17 13:55:07,141 - INFO - Typing new date: 24/12/2025
2025-12-17 13:55:08,581 - INFO - Pressing Enter to confirm...
2025-12-17 13:55:09,184 - INFO - Date changed successfully to: 24/12/2025
2025-12-17 13:55:10,185 - INFO - 
======================================================================
2025-12-17 13:55:10,185 - INFO - SISTEMA AUTOMÁTICO DE AGENDAMIENTO DE CITAS
2025-12-17 13:55:10,185 - INFO - ======================================================================
2025-12-17 13:55:10,185 - INFO - Input: Dr. Soler 09:00 TEMPORAL COELHO, ARTUR

2025-12-17 13:55:10,186 - INFO - Parseado exitoso:
2025-12-17 13:55:10,186 - INFO -  - Doctor: Dr. Soler
2025-12-17 13:55:10,186 - INFO -  - Hora: 09:00
2025-12-17 13:55:10,186 - INFO -  - Paciente: TEMPORAL COELHO, ARTUR

2025-12-17 13:55:10,186 - INFO -  - Nombre del paciente: TEMPORAL COELHO, ARTUR

2025-12-17 13:55:10,186 - INFO -  - Tipo de consulta: C - Consulta Nuevo Paciente

2025-12-17 13:55:10,186 - INFO - 
=== Scheduling appointment with images/doctors/dr_soler.png at 09:00 ===
2025-12-17 13:55:10,186 - INFO - Searching for doctor column: images/doctors/dr_soler.png...
2025-12-17 13:55:10,186 - INFO - Waiting for images/doctors/dr_soler.png to appear (confidence=0.95)...
2025-12-17 13:55:10,471 - INFO - Image found at Box(left=np.int64(373), top=np.int64(378), width=84, height=26)
2025-12-17 13:55:10,473 - INFO - Doctor column found at X=415.0
2025-12-17 13:55:10,474 - INFO - Searching for time row: 09:00...
2025-12-17 13:55:10,474 - INFO - Time image path: images/times/time_9_00.png
2025-12-17 13:55:10,672 - INFO - Time row found at Y=584.0
2025-12-17 13:55:10,672 - INFO - Double-clicking at intersection: (415.0, 584.0)
2025-12-17 13:55:10,797 - INFO - Appointment slot clicked successfully!
2025-12-17 13:55:11,298 - INFO - Typing patient name: TEMPORAL COELHO, ARTUR
2025-12-17 13:55:13,321 - INFO - Looking for 'añadir_paciente' button...
2025-12-17 13:55:13,322 - INFO - Waiting for images/anyadir_paciente.png to appear (confidence=0.9) (grayscale)...
2025-12-17 13:55:14,809 - INFO - Image found at Box(left=np.int64(851), top=np.int64(579), width=14, height=22)
2025-12-17 13:55:14,811 - INFO - Clicking on image at (858.0, 590.0)...
2025-12-17 13:55:15,917 - INFO - 
Selecting consultation type: C - Consulta Nuevo Paciente
2025-12-17 13:55:15,917 - INFO - Looking for 'lupa' button...
2025-12-17 13:55:15,918 - INFO - Waiting for images/lupa.png to appear (confidence=0.7)...
2025-12-17 13:55:16,160 - INFO - Image found at Box(left=np.int64(1443), top=np.int64(437), width=39, height=29)
2025-12-17 13:55:16,160 - INFO - Clicking on image at (1462.5, 451.5)...
2025-12-17 13:55:17,263 - INFO - Looking for consultation type: C - Consulta Nuevo Paciente
2025-12-17 13:55:17,263 - INFO - Waiting for images/tipos_consulta/c_consulta_nuevo_paciente.png to appear (confidence=0.7)...
2025-12-17 13:55:17,484 - INFO - Image found at Box(left=np.int64(656), top=np.int64(446), width=237, height=26)
2025-12-17 13:55:17,484 - INFO - Double-clicking on image at (774.5, 459.0)...
2025-12-17 13:55:18,089 - INFO - Consultation type 'C - Consulta Nuevo Paciente' selected successfully!
2025-12-17 13:55:18,089 - INFO - Waiting for images/guardar.png to appear (confidence=0.9)...
2025-12-17 13:55:20,365 - INFO - Image not found within timeout: images/guardar.png
2025-12-17 13:55:20,365 - INFO - Image images/guardar.png not found, exiting...
2025-12-17 13:55:20,365 - INFO - 'Guardar' button not visible, attempting to scroll using right bar...
2025-12-17 13:55:20,366 - INFO - Waiting for images/barra_lateral.png to appear (confidence=0.7)...
2025-12-17 13:55:20,542 - INFO - Image found at Box(left=np.int64(1889), top=np.int64(125), width=28, height=800)
2025-12-17 13:55:20,542 - INFO - Clicking and dragging right bar at (1903.0, 525.0)...
2025-12-17 13:55:21,247 - INFO - Dragging down...
2025-12-17 13:55:23,520 - INFO - Waiting for images/guardar.png to appear (confidence=0.8)...
2025-12-17 13:55:23,784 - INFO - Image found at Box(left=np.int64(1356), top=np.int64(905), width=129, height=60)
2025-12-17 13:55:23,785 - INFO - Clicking on image at (1420.5, 935.0)...
2025-12-17 13:55:24,888 - INFO - Appointment saved successfully after scrolling!
2025-12-17 13:55:24,888 - INFO - 
¡Cita agendada exitosamente!
2025-12-17 13:55:24,888 - INFO - ======================================================================
2025-12-17 13:55:27,892 - INFO - Waiting for images/logout.png to appear (confidence=0.8)...
2025-12-17 13:55:28,210 - INFO - Image found at Box(left=np.int64(13), top=np.int64(94), width=110, height=113)
2025-12-17 13:55:28,210 - INFO - Clicking on image at (68.0, 150.5)...
2025-12-17 13:55:29,313 - INFO - 
Closing RDP window...
2025-12-17 13:55:31,314 - INFO - Attempting to close RDP window with Alt+F4...
2025-12-17 13:55:32,419 - INFO -  RDP window closed with Alt+F4
2025-12-17 13:55:32,419 - INFO - Ensuring all RDP processes are terminated...
2025-12-17 13:55:32,588 - INFO -  RDP process terminated
2025-12-17 13:55:32,588 - INFO - 
======================================================================
2025-12-17 13:55:32,588 - INFO -  APPOINTMENT SCHEDULED SUCCESSFULLY
2025-12-17 13:55:32,588 - INFO - ======================================================================
