2025-12-16 10:44:26,489 - INFO - 
======================================================================
2025-12-16 10:44:26,489 - INFO - APPOINTMENT SCHEDULING SYSTEM
2025-12-16 10:44:26,489 - INFO - ======================================================================
2025-12-16 10:44:26,489 - INFO - String:     Dr. Soler 12:45 TEMPORAL COELHO, ARTUR
2025-12-16 10:44:26,489 - INFO - ======================================================================

2025-12-16 10:44:26,489 - INFO - Launching RDP session to salus.q-soft.net:8399...
2025-12-16 10:44:26,520 - INFO - Waiting for images/pantalla_inicial.png to appear (confidence=0.7)...
2025-12-16 10:44:36,738 - INFO - Image found at Box(left=np.int64(616), top=np.int64(296), width=682, height=466)
2025-12-16 10:44:36,740 - INFO - Clicking on image at (957.0, 529.0)...
2025-12-16 10:44:37,858 - INFO - Typing credentials...
2025-12-16 10:44:38,276 - INFO - Login submitted.
2025-12-16 10:44:43,277 - INFO - 
Scheduling appointment...
2025-12-16 10:44:43,277 - INFO - 
Setting appointment date to: 19/12/2025
2025-12-16 10:44:43,277 - INFO - 
=== Changing appointment date ===
2025-12-16 10:44:43,277 - INFO - Looking for 'Calendario' label...
2025-12-16 10:44:43,277 - INFO - Waiting for images/calendario.png to appear (confidence=0.95)...
2025-12-16 10:44:43,563 - INFO - Image found at Box(left=np.int64(27), top=np.int64(351), width=141, height=38)
2025-12-16 10:44:43,563 - INFO - 'Calendario' label found at (97.5, 370.0)
2025-12-16 10:44:43,563 - INFO - Clicking on 'Calendario' label...
2025-12-16 10:44:43,975 - INFO - Pressing Tab 2 times to reach date field...
2025-12-16 10:44:44,678 - INFO - Clearing existing date...
2025-12-16 10:44:47,154 - INFO - Typing new date: 19/12/2025
2025-12-16 10:44:48,574 - INFO - Pressing Enter to confirm...
2025-12-16 10:44:49,176 - INFO - Date changed successfully to: 19/12/2025
2025-12-16 10:44:50,177 - INFO - 
======================================================================
2025-12-16 10:44:50,178 - INFO - SISTEMA AUTOMÁTICO DE AGENDAMIENTO DE CITAS
2025-12-16 10:44:50,178 - INFO - ======================================================================
2025-12-16 10:44:50,178 - INFO - Input: Dr. Soler 12:45 TEMPORAL COELHO, ARTUR

2025-12-16 10:44:50,179 - INFO - Parseado exitoso:
2025-12-16 10:44:50,179 - INFO -  - Doctor: Dr. Soler
2025-12-16 10:44:50,179 - INFO -  - Hora: 12:45
2025-12-16 10:44:50,179 - INFO -  - Paciente: TEMPORAL COELHO, ARTUR

2025-12-16 10:44:50,179 - INFO -  - Nombre del paciente: TEMPORAL COELHO, ARTUR

2025-12-16 10:44:50,179 - INFO -  - Tipo de consulta: C - Consulta Nuevo Paciente

2025-12-16 10:44:50,179 - INFO - 
=== Scheduling appointment with images/doctors/dr_soler.png at 12:45 ===
2025-12-16 10:44:50,179 - INFO - Searching for doctor column: images/doctors/dr_soler.png...
2025-12-16 10:44:50,179 - INFO - Waiting for images/doctors/dr_soler.png to appear (confidence=0.95)...
2025-12-16 10:44:50,423 - INFO - Image found at Box(left=np.int64(373), top=np.int64(378), width=84, height=26)
2025-12-16 10:44:50,423 - INFO - Doctor column found at X=415.0
2025-12-16 10:44:50,423 - INFO - Searching for time row: 12:45...
2025-12-16 10:44:50,423 - INFO - Time image path: images/times/time_12_45.png
2025-12-16 10:44:50,603 - INFO - Scroll attempt 1/10...
2025-12-16 10:44:50,604 - INFO - Clicking at (500, 400) to focus window...
2025-12-16 10:44:51,007 - INFO - Moving mouse to (500, 400) for scroll...
2025-12-16 10:44:52,290 - INFO - Time row found at Y=944.5
2025-12-16 10:44:52,290 - INFO - Double-clicking at intersection: (415.0, 944.5)
2025-12-16 10:44:52,392 - INFO - Appointment slot clicked successfully!
2025-12-16 10:44:52,893 - INFO - Typing patient name: TEMPORAL COELHO, ARTUR
2025-12-16 10:44:54,869 - INFO - Looking for 'añadir_paciente' button...
2025-12-16 10:44:54,870 - INFO - Waiting for images/anyadir_paciente.png to appear (confidence=0.9) (grayscale)...
2025-12-16 10:44:57,661 - INFO - Image found at Box(left=np.int64(851), top=np.int64(579), width=14, height=22)
2025-12-16 10:44:57,661 - INFO - Clicking on image at (858.0, 590.0)...
2025-12-16 10:44:58,763 - INFO - 
Selecting consultation type: C - Consulta Nuevo Paciente
2025-12-16 10:44:58,763 - INFO - Looking for 'lupa' button...
2025-12-16 10:44:58,763 - INFO - Waiting for images/lupa.png to appear (confidence=0.7)...
2025-12-16 10:44:59,009 - INFO - Image found at Box(left=np.int64(1443), top=np.int64(437), width=39, height=29)
2025-12-16 10:44:59,009 - INFO - Clicking on image at (1462.5, 451.5)...
2025-12-16 10:45:00,111 - INFO - Looking for consultation type: C - Consulta Nuevo Paciente
2025-12-16 10:45:00,112 - INFO - Waiting for images/tipos_consulta/c_consulta_nuevo_paciente.png to appear (confidence=0.7)...
2025-12-16 10:45:00,368 - INFO - Image found at Box(left=np.int64(656), top=np.int64(446), width=237, height=26)
2025-12-16 10:45:00,368 - INFO - Double-clicking on image at (774.5, 459.0)...
2025-12-16 10:45:00,982 - INFO - Consultation type 'C - Consulta Nuevo Paciente' selected successfully!
2025-12-16 10:45:00,983 - INFO - Waiting for images/guardar.png to appear (confidence=0.9)...
2025-12-16 10:45:03,295 - INFO - Image not found within timeout: images/guardar.png
2025-12-16 10:45:03,295 - INFO - Image images/guardar.png not found, exiting...
2025-12-16 10:45:03,296 - INFO - 'Guardar' button not visible, attempting to scroll using right bar...
2025-12-16 10:45:03,296 - INFO - Waiting for images/barra_lateral.png to appear (confidence=0.7)...
2025-12-16 10:45:03,516 - INFO - Image found at Box(left=np.int64(1889), top=np.int64(124), width=28, height=800)
2025-12-16 10:45:03,517 - INFO - Clicking and dragging right bar at (1903.0, 524.0)...
2025-12-16 10:45:04,219 - INFO - Dragging down...
2025-12-16 10:45:06,488 - INFO - Waiting for images/guardar.png to appear (confidence=0.8)...
2025-12-16 10:45:06,770 - INFO - Image found at Box(left=np.int64(1356), top=np.int64(905), width=129, height=60)
2025-12-16 10:45:06,770 - INFO - Clicking on image at (1420.5, 935.0)...
2025-12-16 10:45:07,872 - INFO - Appointment saved successfully after scrolling!
2025-12-16 10:45:07,872 - INFO - 
¡Cita agendada exitosamente!
2025-12-16 10:45:07,872 - INFO - ======================================================================
2025-12-16 10:45:10,873 - INFO - Waiting for images/logout.png to appear (confidence=0.8)...
2025-12-16 10:45:11,299 - INFO - Image found at Box(left=np.int64(13), top=np.int64(94), width=110, height=113)
2025-12-16 10:45:11,299 - INFO - Clicking on image at (68.0, 150.5)...
2025-12-16 10:45:12,402 - INFO - Waiting for images/si_button.png to appear (confidence=0.7)...
2025-12-16 10:45:58,427 - INFO - Image found at Box(left=np.int64(823), top=np.int64(627), width=145, height=54)
2025-12-16 10:45:58,427 - INFO - Clicking on image at (895.5, 654.0)...
2025-12-16 10:45:59,558 - INFO - 
Closing RDP window...
2025-12-16 10:46:01,559 - INFO - Attempting to close RDP window with Alt+F4...
2025-12-16 10:46:02,662 - INFO -  RDP window closed with Alt+F4
2025-12-16 10:46:02,663 - INFO - Ensuring all RDP processes are terminated...
2025-12-16 10:46:02,898 - INFO -  RDP process terminated
2025-12-16 10:46:02,898 - INFO - 
======================================================================
2025-12-16 10:46:02,898 - INFO -  APPOINTMENT SCHEDULED SUCCESSFULLY
2025-12-16 10:46:02,898 - INFO - ======================================================================
